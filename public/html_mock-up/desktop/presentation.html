<!DOCTYPE html>
<html>

<head>
    <title>Desktop - Presentation</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.8/css/all.css">
    <style>
        body {
            background: black;
        }

        .slide {
            display: none;
            height: 100vh;
            width: 100vw;
            text-align: center;
        }

        .slide-poll {
            background: white;
        }

        .slide.active {
            display: block;
        }

        .slide img {
            max-width: 100%;
            height: auto;
            max-height: 100%;
        }

        div.control {
            position: absolute;
            top: 10px;
            background-color: #f0f0f0;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 7px;
        }

        div.control a {
            width: 42px;
            height: 42px;
            padding: 5px;
            text-align: center;
            display: inline-block;
            border-radius: 8px;
        }

        div.control a:hover {
            background-color: #E3E3E3;
        }

        div.control a.selected {
            background-color: #D6D6D6;
        }

        #presentation {
            width: 100vw;
            height: 100vh;
        }

        div.presentation-control {
            left: 60px;
        }

        div.drawing-control {
            right: 60px;
        }

        i {
            color: grey;
        }

        a:hover {
            text-decoration: unset;
        }

        div.tools {
            height: 42px;
        }

        div.colors {
            height: 42px;
            margin-top: 4px;
        }

        .colors div {
            width: 22px;
            height: 22px;
            border-radius: 11px;
            margin: 5px;
        }

        .color-black div {
            background-color: #000000;
        }

        .color-red div {
            background-color: #f7412d;
        }

        .color-green div {
            background-color: #47b04b;
        }

        .color-blue div {
            background-color: #1194f6;
        }

        .color-yellow div {
            background-color: #ffc200;
        }

        .color-purple div {
            background-color: #9d1bb2;
        }

        .color-pink div {
            background-color: #ec1561;
        }

        .color-brown div {
            background-color: #7a5547;
        }

        .color-grey div {
            background-color: #ced4da;
        }

        .color-white div {
            background-color: #ffffff;
        }

        #drawing {
            background: transparent;
            position: absolute;
            top: 0px;
            left: 0px;
            width: 100vw;
            height: 100vh;
        }

        #drawing.white-background {
            background: white;
        }

        #drawing>canvas {
            border-top: 0 !important;
            top: 50px !important;
            /* height: 32px !important; */
            left: calc(100vw - 300px) !important;
        }

        .question-container {
            height: 40vh;
            padding: 50px;
        }

        .question-container .list-group {
            margin-top: 30px;
            width: 80%;
            margin: auto;
        }

        .chart-container {
            height: 60vh;
            padding: 0 100px 50px 100px;
        }

        .item-a {
            background-color: #ffb3c2;
        }

        .item-b {
            background-color: #aae0df;
        }

        .item-c {
            background-color: #9fd0f6;
        }

        .item-d {
            background-color: #ffe6ad;
        }
    </style>
</head>

<body>
    <div id="presentation">
        <div class="slide slide-1 slide-img active">
            <img src="/html_mock-up/presentation-slide-example/slide-1.jpg">
        </div>
        <div class="slide slide-2 slide-poll">
            <div class="question-container">
                <h1>Question?</h1>
                <ul class="list-group">
                    <li class="list-group-item item-a">A. response 1</li>
                    <li class="list-group-item item-b">B. response 2</li>
                    <li class="list-group-item item-c">C. response 3</li>
                    <li class="list-group-item item-d">D. response 4</li>
                </ul>
            </div>
            <div class="chart-container">
                <canvas id="myChart"></canvas>
            </div>
        </div>
    </div>
    <div id="drawing"></div>

    <div class="control presentation-control">
        <a href="#" class="previous-slide" data-toggle="tooltip" data-placement="bottom" title="Previous slide [left]" data-shortcut="left">
            <i class="fas fa-arrow-alt-circle-left fa-2x"></i>
        </a>
        <a data-toggle="tooltip" data-placement="bottom" title="Dashboard" href="/html_mock-up/desktop/dashboard.html">
            <i class="fas fa-th fa-2x"></i>
        </a>
        <a href="#" class="toggle-fullscreen" data-toggle="tooltip" data-placement="bottom" title="Toggle Fullscreen [ f ]" data-shortcut="f">
            <i class="fas fa-desktop fa-2x"></i>
        </a>
        <a href="#" class="next-slide" data-toggle="tooltip" data-placement="bottom" title="Next slide [right]" data-shortcut="right">
            <i class="fas fa-arrow-alt-circle-right fa-2x"></i>
        </a>
        <a href="#" id="addone" data-toggle="tooltip" data-placement="bottom" title="Up Vote [=]" data-shortcut="=">
            <i class="fas fa-plus fa-2x"></i>
        </a>
    </div>
    <div class="control drawing-control">
        <div class="tools">
            <a href="#" class="select" data-toggle="tooltip" data-placement="bottom" title="Select [ v ]" data-shortcut="v">
                <img src="/img/select-tool.svg">
            </a>
            <a href="#" class="pen" data-toggle="tooltip" data-placement="bottom" title="Pen [ p ]" data-shortcut="p">
                <img src="/img/pen-tool.svg">
            </a>
            <a href="#" class="eraser" data-toggle="tooltip" data-placement="bottom" title="Eraser [ e ]" data-shortcut="e">
                <img src="/img/eraser-tool.svg">
            </a>
            <a href="#" class="rectangle" data-toggle="tooltip" data-placement="bottom" title="Rectangle [ r ]" data-shortcut="r">
                <img src="/img/rectangle-tool.svg">
            </a>
            <a href="#" class="line" data-toggle="tooltip" data-placement="bottom" title="Line(s) [ l ]" data-shortcut="l">
                <img src="/img/line-tool.svg">
            </a>
            <a href="#" class="circle" data-toggle="tooltip" data-placement="bottom" title="Circle [ c ]" data-shortcut="c">
                <img src="/img/circle-tool.svg">
            </a>
            <a href="#" class="text" data-toggle="tooltip" data-placement="bottom" title="Text [ t ]" data-shortcut="t">
                <img src="/img/text-tool.svg">
            </a>
            <a href="#" class="background" data-toggle="tooltip" data-placement="bottom" title="White background [ w ]" data-shortcut="w">
                <img src="/img/background-tool.svg">
            </a>
            <a href="#" class="undo" data-toggle="tooltip" data-placement="bottom" title="Undo [ u ]" data-shortcut="u">
                <img src="/img/undo-tool.svg">
            </a>
            <a href="#" class="redo" data-toggle="tooltip" data-placement="bottom" title="Redo [ U ]" data-shortcut="shift+u">
                <img src="/img/redo-tool.svg">
            </a>
        </div>
        <div class="colors">
            <a href="#" class="color-black" data-toggle="tooltip" data-placement="bottom" title="Black [ 1 ]" data-shortcut="1">
                <div></div>
            </a>
            <a href="#" class="color-red" data-toggle="tooltip" data-placement="bottom" title="Red [ 2 ]" data-shortcut="2">
                <div></div>
            </a>
            <a href="#" class="color-green" data-toggle="tooltip" data-placement="bottom" title="Green [ 3 ]" data-shortcut="3">
                <div></div>
            </a>
            <a href="#" class="color-blue" data-toggle="tooltip" data-placement="bottom" title="Blue [ 4 ]" data-shortcut="4">
                <div></div>
            </a>
            <a href="#" class="color-yellow" data-toggle="tooltip" data-placement="bottom" title="Yellow [ 5 ]" data-shortcut="5">
                <div></div>
            </a>
            <a href="#" class="color-purple" data-toggle="tooltip" data-placement="bottom" title="Purple [ 6 ]" data-shortcut="6">
                <div></div>
            </a>
            <a href="#" class="color-pink" data-toggle="tooltip" data-placement="bottom" title="Pink [ 7 ]" data-shortcut="7">
                <div></div>
            </a>
            <a href="#" class="color-brown" data-toggle="tooltip" data-placement="bottom" title="Brown [ 8 ]" data-shortcut="8">
                <div></div>
            </a>
            <a href="#" class="color-grey" data-toggle="tooltip" data-placement="bottom" title="Grey [ 9 ]" data-shortcut="9">
                <div></div>
            </a>
            <a href="#" class="color-white" data-toggle="tooltip" data-placement="bottom" title="White [ 0 ]" data-shortcut="0">
                <div></div>
            </a>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/jquery.hotkeys@0.1.0/jquery.hotkeys.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js"></script>
    <script src="/js/zwibbler2.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.0.3/socket.io.slim.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.bundle.js"></script>
    <script src="../../js/testcanvas.js"></script>
    <script>
        // load slides
        var nb_slides = 21;
        var current_slide = 1;

        // Shortcuts
        $('[data-shortcut]').each(function () {
            var element = $(this);
            key = element.data('shortcut');

            $(document).on('keyup', null, String(key), function () {
                element.trigger('focus').trigger('click');
            });
        });

        // drawing
        var ctx = Zwibbler.create("drawing", {
            showToolbar: false,
            showColourPanel: false
        });
        $('.tools a').click(function (e) {
            e.preventDefault();
            if (!$(this).hasClass('selected')) {
                var action = $(this).attr('class');
                if (action == 'select') {
                    ctx.usePickTool();
                } else if (action == 'pen') {
                    ctx.useBrushTool({
                        lineWidth: 8,
                    });
                } else if (action == 'eraser') {
                    ctx.useBrushTool({
                        lineWidth: 8,
                        strokeStyle: "erase"
                    });
                } else if (action == 'line') {
                    ctx.useLineTool();
                } else if (action == 'rectangle') {
                    ctx.useRectangleTool();
                } else if (action == 'circle') {
                    ctx.useCircleTool();
                } else if (action == 'text') {
                    ctx.useTextTool();
                } else if (action == 'background') {
                    $('#drawing').toggleClass('white-background');
                } else if (action == 'undo') {
                    ctx.undo();
                } else if (action == 'redo') {
                    ctx.redo();
                }
                if (action != 'background' && action != 'undo' && action != 'redo') {
                    $('.tools a.selected').removeClass('selected');
                    $(this).addClass('selected');
                }
            }
            $(this).blur();
        });
        $('.colors a').click(function (e) {
            e.preventDefault();
            if (!$(this).hasClass('selected')) {
                var color = $(this).find('div').css('background-color');
                ctx.setColour(color, true);
                $('.colors a.selected').removeClass('selected');
                $(this).addClass('selected');
            }
            $(this).blur();
        });

        ctx.on("tool-changed", function (toolname) {
            console.log(toolname);
            if (toolname == 'pick') {
                $('.tools a.selected').removeClass('selected');
                $('.tools a.select').addClass('selected');
            }
        });
        // default tool
        $(function () {
            $('.pen').click();
            $('.color-black').click();
        });

        // navigation
        $('.previous-slide').click(function (e) {
            e.preventDefault();
            $('.slide.active').removeClass('active');
            current_slide = (current_slide == 1) ? nb_slides : current_slide - 1;
            $('.slide.slide-' + current_slide).addClass('active');
            ctx.setCurrentPage(current_slide - 1);
            $('#drawing').removeClass('white-background');
            $(this).blur();
        });
        $('.next-slide').click(function (e) {
            e.preventDefault();
            $('.slide.active').removeClass('active');
            current_slide = (current_slide == nb_slides) ? 1 : current_slide + 1;
            $('.slide.slide-' + current_slide).addClass('active');
            ctx.setCurrentPage(current_slide - 1);
            $('#drawing').removeClass('white-background');
            $(this).blur();
        });
        var fadeout = null;
        $("html").mousemove(function () {
            $(".control").stop().show();
            if (fadeout != null) {
                clearTimeout(fadeout);
            }
            fadeout = setTimeout(hide_control, 2000);
        });
        function hide_control() {
            $(".control").stop().hide();
        }
        $("html").mousemove();

        // fullscreen
        $('.toggle-fullscreen').click(function (e) {
            e.preventDefault();
            toggleFullScreen();
            $(this).blur();
        });
        function toggleFullScreen() {
            if (!document.fullscreenElement && !document.mozFullScreenElement && !document.webkitFullscreenElement && !document.msFullscreenElement) {
                if (document.documentElement.requestFullscreen) {
                    document.documentElement.requestFullscreen();
                } else if (document.documentElement.msRequestFullscreen) {
                    document.documentElement.msRequestFullscreen();
                } else if (document.documentElement.mozRequestFullScreen) {
                    document.documentElement.mozRequestFullScreen();
                } else if (document.documentElement.webkitRequestFullscreen) {
                    document.documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);
                }
            } else {
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                } else if (document.msExitFullscreen) {
                    document.msExitFullscreen();
                } else if (document.mozCancelFullScreen) {
                    document.mozCancelFullScreen();
                } else if (document.webkitExitFullscreen) {
                    document.webkitExitFullscreen();
                }
            }
        }
        
        // adding fake slides
        for (let i = 3; i <= 21; i++) {
            $('#presentation').append(`<div class="slide slide-${i} slide-img">
            <img src="/html_mock-up/presentation-slide-example/slide-${i}.jpg">
        </div>`);
            ctx.addPage();
        }
        
        // activate tooltip
        $(function () {
            $('[data-toggle="tooltip"]').tooltip();
        });
    </script>
</body>

</html>